--- mono/native/Makefile.am.orig	2022-03-18 08:48:15.941365000 +0000
+++ mono/native/Makefile.am
@@ -34,28 +34,7 @@ common_sources = \
 	../../external/corefx/src/Native/Unix/System.Native/pal_uid.h \
 	../../external/corefx/src/Native/Unix/System.Native/pal_time.c \
 	../../external/corefx/src/Native/Unix/System.Native/pal_time.h \
-	../../external/corefx/src/Native/AnyOS/brotli/enc/dictionary_hash.c \
-	../../external/corefx/src/Native/AnyOS/brotli/enc/backward_references_hq.c \
-	../../external/corefx/src/Native/AnyOS/brotli/enc/histogram.c \
-	../../external/corefx/src/Native/AnyOS/brotli/enc/memory.c \
-	../../external/corefx/src/Native/AnyOS/brotli/enc/entropy_encode.c \
-	../../external/corefx/src/Native/AnyOS/brotli/enc/compress_fragment_two_pass.c \
-	../../external/corefx/src/Native/AnyOS/brotli/enc/block_splitter.c \
-	../../external/corefx/src/Native/AnyOS/brotli/enc/encode.c \
-	../../external/corefx/src/Native/AnyOS/brotli/enc/cluster.c \
-	../../external/corefx/src/Native/AnyOS/brotli/enc/backward_references.c \
-	../../external/corefx/src/Native/AnyOS/brotli/enc/utf8_util.c \
-	../../external/corefx/src/Native/AnyOS/brotli/enc/compress_fragment.c \
-	../../external/corefx/src/Native/AnyOS/brotli/enc/brotli_bit_stream.c \
-	../../external/corefx/src/Native/AnyOS/brotli/enc/bit_cost.c \
-	../../external/corefx/src/Native/AnyOS/brotli/enc/static_dict.c \
-	../../external/corefx/src/Native/AnyOS/brotli/enc/literal_cost.c \
-	../../external/corefx/src/Native/AnyOS/brotli/enc/metablock.c \
-	../../external/corefx/src/Native/AnyOS/brotli/dec/state.c \
-	../../external/corefx/src/Native/AnyOS/brotli/dec/decode.c \
-	../../external/corefx/src/Native/AnyOS/brotli/dec/huffman.c \
-	../../external/corefx/src/Native/AnyOS/brotli/dec/bit_reader.c \
-	../../external/corefx/src/Native/AnyOS/brotli/common/dictionary.c
+	../../external/corefx/src/Native/AnyOS/brotli/common/context.h ../../external/corefx/src/Native/AnyOS/brotli/common/constants.c ../../external/corefx/src/Native/AnyOS/brotli/common/transform.c ../../external/corefx/src/Native/AnyOS/brotli/common/platform.h ../../external/corefx/src/Native/AnyOS/brotli/common/dictionary.c ../../external/corefx/src/Native/AnyOS/brotli/common/transform.h ../../external/corefx/src/Native/AnyOS/brotli/common/version.h ../../external/corefx/src/Native/AnyOS/brotli/common/context.c ../../external/corefx/src/Native/AnyOS/brotli/common/constants.h ../../external/corefx/src/Native/AnyOS/brotli/common/dictionary.h ../../external/corefx/src/Native/AnyOS/brotli/common/platform.c ../../external/corefx/src/Native/AnyOS/brotli/dec/huffman.c ../../external/corefx/src/Native/AnyOS/brotli/dec/bit_reader.h ../../external/corefx/src/Native/AnyOS/brotli/dec/state.h ../../external/corefx/src/Native/AnyOS/brotli/dec/state.c ../../external/corefx/src/Native/AnyOS/brotli/dec/bit_reader.c ../../external/corefx/src/Native/AnyOS/brotli/dec/huffman.h ../../external/corefx/src/Native/AnyOS/brotli/dec/prefix.h ../../external/corefx/src/Native/AnyOS/brotli/dec/decode.c ../../external/corefx/src/Native/AnyOS/brotli/include/brotli/types.h ../../external/corefx/src/Native/AnyOS/brotli/include/brotli/port.h ../../external/corefx/src/Native/AnyOS/brotli/include/brotli/decode.h ../../external/corefx/src/Native/AnyOS/brotli/include/brotli/encode.h ../../external/corefx/src/Native/AnyOS/brotli/enc/bit_cost.h ../../external/corefx/src/Native/AnyOS/brotli/enc/encoder_dict.c ../../external/corefx/src/Native/AnyOS/brotli/enc/block_splitter.h ../../external/corefx/src/Native/AnyOS/brotli/enc/encode.c ../../external/corefx/src/Native/AnyOS/brotli/enc/hash_longest_match_inc.h ../../external/corefx/src/Native/AnyOS/brotli/enc/block_encoder_inc.h ../../external/corefx/src/Native/AnyOS/brotli/enc/backward_references_hq.h ../../external/corefx/src/Native/AnyOS/brotli/enc/brotli_bit_stream.c ../../external/corefx/src/Native/AnyOS/brotli/enc/compress_fragment_two_pass.h ../../external/corefx/src/Native/AnyOS/brotli/enc/entropy_encode.c ../../external/corefx/src/Native/AnyOS/brotli/enc/hash_forgetful_chain_inc.h ../../external/corefx/src/Native/AnyOS/brotli/enc/literal_cost.h ../../external/corefx/src/Native/AnyOS/brotli/enc/static_dict.c ../../external/corefx/src/Native/AnyOS/brotli/enc/quality.h ../../external/corefx/src/Native/AnyOS/brotli/enc/bit_cost_inc.h ../../external/corefx/src/Native/AnyOS/brotli/enc/prefix.h ../../external/corefx/src/Native/AnyOS/brotli/enc/write_bits.h ../../external/corefx/src/Native/AnyOS/brotli/enc/command.h ../../external/corefx/src/Native/AnyOS/brotli/enc/find_match_length.h ../../external/corefx/src/Native/AnyOS/brotli/enc/hash_rolling_inc.h ../../external/corefx/src/Native/AnyOS/brotli/enc/backward_references.h ../../external/corefx/src/Native/AnyOS/brotli/enc/fast_log.h ../../external/corefx/src/Native/AnyOS/brotli/enc/utf8_util.h ../../external/corefx/src/Native/AnyOS/brotli/enc/cluster.c ../../external/corefx/src/Native/AnyOS/brotli/enc/histogram.c ../../external/corefx/src/Native/AnyOS/brotli/enc/metablock.c ../../external/corefx/src/Native/AnyOS/brotli/enc/dictionary_hash.h ../../external/corefx/src/Native/AnyOS/brotli/enc/params.h ../../external/corefx/src/Native/AnyOS/brotli/enc/hash_composite_inc.h ../../external/corefx/src/Native/AnyOS/brotli/enc/memory.h ../../external/corefx/src/Native/AnyOS/brotli/enc/compress_fragment.c ../../external/corefx/src/Native/AnyOS/brotli/enc/backward_references_inc.h ../../external/corefx/src/Native/AnyOS/brotli/enc/hash_to_binary_tree_inc.h ../../external/corefx/src/Native/AnyOS/brotli/enc/histogram_inc.h ../../external/corefx/src/Native/AnyOS/brotli/enc/command.c ../../external/corefx/src/Native/AnyOS/brotli/enc/entropy_encode.h ../../external/corefx/src/Native/AnyOS/brotli/enc/cluster_inc.h ../../external/corefx/src/Native/AnyOS/brotli/enc/literal_cost.c ../../external/corefx/src/Native/AnyOS/brotli/enc/static_dict.h ../../external/corefx/src/Native/AnyOS/brotli/enc/hash_longest_match64_inc.h ../../external/corefx/src/Native/AnyOS/brotli/enc/backward_references_hq.c ../../external/corefx/src/Native/AnyOS/brotli/enc/brotli_bit_stream.h ../../external/corefx/src/Native/AnyOS/brotli/enc/compress_fragment_two_pass.c ../../external/corefx/src/Native/AnyOS/brotli/enc/hash.h ../../external/corefx/src/Native/AnyOS/brotli/enc/bit_cost.c ../../external/corefx/src/Native/AnyOS/brotli/enc/encoder_dict.h ../../external/corefx/src/Native/AnyOS/brotli/enc/entropy_encode_static.h ../../external/corefx/src/Native/AnyOS/brotli/enc/block_splitter.c ../../external/corefx/src/Native/AnyOS/brotli/enc/metablock.h ../../external/corefx/src/Native/AnyOS/brotli/enc/dictionary_hash.c ../../external/corefx/src/Native/AnyOS/brotli/enc/memory.c ../../external/corefx/src/Native/AnyOS/brotli/enc/compress_fragment.h ../../external/corefx/src/Native/AnyOS/brotli/enc/metablock_inc.h ../../external/corefx/src/Native/AnyOS/brotli/enc/histogram.h ../../external/corefx/src/Native/AnyOS/brotli/enc/static_dict_lut.h ../../external/corefx/src/Native/AnyOS/brotli/enc/block_splitter_inc.h ../../external/corefx/src/Native/AnyOS/brotli/enc/backward_references.c ../../external/corefx/src/Native/AnyOS/brotli/enc/fast_log.c ../../external/corefx/src/Native/AnyOS/brotli/enc/hash_longest_match_quickly_inc.h ../../external/corefx/src/Native/AnyOS/brotli/enc/utf8_util.c ../../external/corefx/src/Native/AnyOS/brotli/enc/ringbuffer.h ../../external/corefx/src/Native/AnyOS/brotli/enc/cluster.h 
 
 macos_sources = $(unix_sources)
 
@@ -161,6 +140,7 @@ common_cflags = \
 	-I$(abs_top_srcdir)/external/corefx/src/Native/AnyOS/brotli/include \
 	$(GLIB_CFLAGS) \
 	$(SHARED_CFLAGS) \
+	$(METADATA_CFLAGS) \
 	-DBROTLI_BUILD_NO_RBIT \
 	-Wno-typedef-redefinition
 
